import getConfig from 'next/config';
import { Node, Browser } from '@logtail/js';
import { prop } from 'ramda';

const { serverRuntimeConfig, publicRuntimeConfig } = getConfig();

let Logtail, logtailSourceToken;
if (typeof window != 'undefined' && window.document) {
  logtailSourceToken = prop('logtailSourceToken', publicRuntimeConfig);
  Logtail = Browser;
} else {
  Logtail = Node;
  logtailSourceToken = prop('logtailSourceToken', serverRuntimeConfig);
}

const logtail = new Logtail(logtailSourceToken);
export default logtail;