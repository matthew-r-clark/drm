import getConfig from 'next/config';
import { Node, Browser } from '@logtail/js';
import { prop } from 'ramda';

const { publicRuntimeConfig } = getConfig();
const logtailSourceToken = prop('logtailSourceToken', publicRuntimeConfig);

let Logtail;
if (typeof window != 'undefined' && window.document) {
  console.log('logging from browser');
  Logtail = Browser;
} else {
  console.log('logging from server');
  Logtail = Node;
}

const logtail = new Logtail(logtailSourceToken);

logtail.use(function(log) {
  return {
    ...log,
  };
});

export default logtail;